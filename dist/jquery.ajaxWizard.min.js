!function(a){function g(b,c){this.element=b,this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="ajaxWizard",f={contentUrl:null,controlSelectors:{forward:".forward",backward:".backward"},beforeForward:function(){return!0},afterForward:function(){return!0},afterCachedForward:function(){return!0},beforeBackward:function(){return!0},afterBackward:function(){return!0}};a.extend(g.prototype,{init:function(){a(this.element).find("fieldset:first-child").addClass("current"),this.eventListeners()},currentStep:function(){return a(this.element).find("fieldset.current")},getContentUrl:function(){if(null===this.settings.contentUrl)throw new Error("contentUrl not defined");return this.settings.contentUrl},generateUniqueKey:function(){return(Math.random()*Math.random()).toString(16).substr(2,16)},whenCallingNextStep:function(b){a(b).data("ajax-wizard-key")&&a(b).data("ajax-wizard-hash")===this.currentStep().serialize()?(this.animate(this.currentStep(),a("."+a(b).data("ajax-wizard-key"))),this.afterCachedForwardCallback(this.element)):(a("."+a(b).data("ajax-wizard-key")).remove(),this.forward(b))},beforeForwardCallback:function(){return this.settings.beforeForward.call(this,this.element)},afterForwardCallback:function(){return this.settings.afterForward.call(this,this.element)},afterCachedForwardCallback:function(){return this.settings.afterCachedForward.call(this,this.element)},beforeBackwardCallback:function(){return this.settings.beforeBackward.call(this,this.element)},afterBackwardCallback:function(){return this.settings.afterBackward.call(this,this.element)},ajaxRequest:function(b){var c=this,d=this.currentStep().find("input, select, textarea").serialize();a.ajax({url:c.getContentUrl(),dataType:"html",method:"post",data:d,success:function(e){c.currentStep().after("<fieldset>"+e+"</fieldset>");var f=c.currentStep().next("fieldset");c.animate(c.currentStep(),f);var g=c.generateUniqueKey();a(b).data("ajax-wizard-key",g),a(b).data("ajax-wizard-hash",d),f.addClass(g),c.afterForwardCallback(this.element)}})},forward:function(a){this.beforeForwardCallback()===!0&&this.ajaxRequest(a)},backward:function(){this.beforeBackwardCallback()===!0&&(this.animate(this.currentStep(),this.currentStep().prev("fieldset")),this.afterBackwardCallback())},eventListeners:function(){var b=this;a(this.element).on("submit",function(a){a.preventDefault(),b.whenCallingNextStep(this)}),a(this.element).on("click",this.settings.controlSelectors.forward,function(){b.whenCallingNextStep(this)}),a(this.element).on("click",this.settings.controlSelectors.backward,function(){b.backward()})},animate:function(a,b){a.hide().removeClass("current"),b.fadeIn().addClass("current")}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new g(this,b))}),this}}(jQuery,window,document);